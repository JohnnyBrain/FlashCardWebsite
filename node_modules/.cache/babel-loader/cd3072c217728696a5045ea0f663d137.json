{"ast":null,"code":"/**\n * Way data is stored for this database\n * For a Node.js/Node Webkit database it's the file system\n * For a browser-side database it's localforage, which uses the best backend available (IndexedDB then WebSQL then localStorage)\n *\n * This version is the browser version\n */\nvar localforage = require('localforage'); // Configure localforage to display NeDB name for now. Would be a good idea to let user use his own app name\n\n\nlocalforage.config({\n  name: 'NeDB',\n  storeName: 'nedbdata'\n});\n\nfunction exists(filename, callback) {\n  localforage.getItem(filename, function (err, value) {\n    if (value !== null) {\n      // Even if value is undefined, localforage returns null\n      return callback(true);\n    } else {\n      return callback(false);\n    }\n  });\n}\n\nfunction rename(filename, newFilename, callback) {\n  localforage.getItem(filename, function (err, value) {\n    if (value === null) {\n      localforage.removeItem(newFilename, function () {\n        return callback();\n      });\n    } else {\n      localforage.setItem(newFilename, value, function () {\n        localforage.removeItem(filename, function () {\n          return callback();\n        });\n      });\n    }\n  });\n}\n\nfunction writeFile(filename, contents, options, callback) {\n  // Options do not matter in browser setup\n  if (typeof options === 'function') {\n    callback = options;\n  }\n\n  localforage.setItem(filename, contents, function () {\n    return callback();\n  });\n}\n\nfunction appendFile(filename, toAppend, options, callback) {\n  // Options do not matter in browser setup\n  if (typeof options === 'function') {\n    callback = options;\n  }\n\n  localforage.getItem(filename, function (err, contents) {\n    contents = contents || '';\n    contents += toAppend;\n    localforage.setItem(filename, contents, function () {\n      return callback();\n    });\n  });\n}\n\nfunction readFile(filename, options, callback) {\n  // Options do not matter in browser setup\n  if (typeof options === 'function') {\n    callback = options;\n  }\n\n  localforage.getItem(filename, function (err, contents) {\n    return callback(null, contents || '');\n  });\n}\n\nfunction unlink(filename, callback) {\n  localforage.removeItem(filename, function () {\n    return callback();\n  });\n} // Nothing to do, no directories will be used on the browser\n\n\nfunction mkdirp(dir, callback) {\n  return callback();\n} // Nothing to do, no data corruption possible in the brower\n\n\nfunction ensureDatafileIntegrity(filename, callback) {\n  return callback(null);\n} // Interface\n\n\nmodule.exports.exists = exists;\nmodule.exports.rename = rename;\nmodule.exports.writeFile = writeFile;\nmodule.exports.crashSafeWriteFile = writeFile; // No need for a crash safe function in the browser\n\nmodule.exports.appendFile = appendFile;\nmodule.exports.readFile = readFile;\nmodule.exports.unlink = unlink;\nmodule.exports.mkdirp = mkdirp;\nmodule.exports.ensureDatafileIntegrity = ensureDatafileIntegrity;","map":{"version":3,"names":["localforage","require","config","name","storeName","exists","filename","callback","getItem","err","value","rename","newFilename","removeItem","setItem","writeFile","contents","options","appendFile","toAppend","readFile","unlink","mkdirp","dir","ensureDatafileIntegrity","module","exports","crashSafeWriteFile"],"sources":["/Users/johnbrain/Projects/FlashCardProject/node_modules/nedb/browser-version/browser-specific/lib/storage.js"],"sourcesContent":["/**\n * Way data is stored for this database\n * For a Node.js/Node Webkit database it's the file system\n * For a browser-side database it's localforage, which uses the best backend available (IndexedDB then WebSQL then localStorage)\n *\n * This version is the browser version\n */\n\nvar localforage = require('localforage')\n\n// Configure localforage to display NeDB name for now. Would be a good idea to let user use his own app name\nlocalforage.config({\n  name: 'NeDB'\n, storeName: 'nedbdata'\n});\n\n\nfunction exists (filename, callback) {\n  localforage.getItem(filename, function (err, value) {\n    if (value !== null) {   // Even if value is undefined, localforage returns null\n      return callback(true);\n    } else {\n      return callback(false);\n    }\n  });\n}\n\n\nfunction rename (filename, newFilename, callback) {\n  localforage.getItem(filename, function (err, value) {\n    if (value === null) {\n      localforage.removeItem(newFilename, function () { return callback(); });\n    } else {\n      localforage.setItem(newFilename, value, function () {\n        localforage.removeItem(filename, function () { return callback(); });\n      });\n    }\n  });\n}\n\n\nfunction writeFile (filename, contents, options, callback) {\n  // Options do not matter in browser setup\n  if (typeof options === 'function') { callback = options; }\n  localforage.setItem(filename, contents, function () { return callback(); });\n}\n\n\nfunction appendFile (filename, toAppend, options, callback) {\n  // Options do not matter in browser setup\n  if (typeof options === 'function') { callback = options; }\n\n  localforage.getItem(filename, function (err, contents) {\n    contents = contents || '';\n    contents += toAppend;\n    localforage.setItem(filename, contents, function () { return callback(); });\n  });\n}\n\n\nfunction readFile (filename, options, callback) {\n  // Options do not matter in browser setup\n  if (typeof options === 'function') { callback = options; }\n  localforage.getItem(filename, function (err, contents) { return callback(null, contents || ''); });\n}\n\n\nfunction unlink (filename, callback) {\n  localforage.removeItem(filename, function () { return callback(); });\n}\n\n\n// Nothing to do, no directories will be used on the browser\nfunction mkdirp (dir, callback) {\n  return callback();\n}\n\n\n// Nothing to do, no data corruption possible in the brower\nfunction ensureDatafileIntegrity (filename, callback) {\n  return callback(null);\n}\n\n\n// Interface\nmodule.exports.exists = exists;\nmodule.exports.rename = rename;\nmodule.exports.writeFile = writeFile;\nmodule.exports.crashSafeWriteFile = writeFile;   // No need for a crash safe function in the browser\nmodule.exports.appendFile = appendFile;\nmodule.exports.readFile = readFile;\nmodule.exports.unlink = unlink;\nmodule.exports.mkdirp = mkdirp;\nmodule.exports.ensureDatafileIntegrity = ensureDatafileIntegrity;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}